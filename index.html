<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>KAMI</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta property="og:type" content="website">
<meta property="og:title" content="KAMI">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="KAMI">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KAMI">
<meta name="twitter:image" content="http://yoursite.com/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="KAMI" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active" href="/">首页</a>
                
                <a class="navbar-item" href="/archives">文章</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:27:37.078Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 分钟 读完 (大约 136 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/hexo+gitpages/">Hexo+Gitpages 搭建流程</a>
            
        </h1>
        <div class="content">
            <p>首先安装 nodejs <code>npm -version</code> 出现版本，则安装成功</p>
<ol>
<li>安装 hexo-cli</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建目录</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir hexo_blog</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>初始化hexo</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init hexo_blog</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>进入目录</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd hexo_blog</span><br></pre></td></tr></table></figure>

<p>  5 . 安装 </p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<ol start="6">
<li><p>启动hexo 服务 (访问localhost:4000 成功则ok)</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改配置文件 （_config.yml）  Theme目录下面<br>deploy:<br>type: git<br>repo: <a href="https://github.com/467812367/467812367.github.io.git" target="_blank" rel="noopener">https://github.com/467812367/467812367.github.io.git</a><br>branch: master</p>
</li>
<li><p>安装部署插件</p>
</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>部署到github上</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>先清除，后部署  (清除部署)（要输入账户密码）    </li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>


        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.225Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 分钟 读完 (大约 2436 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/一些设计上的基本常识 - 梁飞/">基本常识 （转）</a>
            
        </h1>
        <div class="content">
            <h3 id="API与SPI分离"><a href="#API与SPI分离" class="headerlink" title="API与SPI分离"></a>API与SPI分离</h3><p>框架或组件通常有两类客户，一个是使用者，一个是扩展者，<br>API(Application Programming Interface)是给使用者用的，<br>而SPI(Service Provide Interface)是给扩展者用的，<br>在设计时，尽量把它们隔离开，而不要混在一起，<br>也就是说，使用者是看不到扩展者写的实现的，<br>比如：一个Web框架，它有一个API接口叫Action， 里面有个execute()方法，是给使用者用来写业务逻辑的，<br>然后，Web框架有一个SPI接口给扩展者控制输出方式， 比如用velocity模板输出还是用json输出等，<br>如果这个Web框架使用一个都继承Action的VelocityAction和一个JsonAction做为扩展方式，<br>要用velocity模板输出的就继承VelocityAction，要用json输出的就继承JsonAction，<br>这就是API和SPI没有分离的反面例子，SPI接口混在了API接口中，<br>合理的方式是，有一个单独的Renderer接口，有VelocityRenderer和JsonRenderer实现，<br>Web框架将Action的输出转交给Renderer接口做渲染输出。 </p>
<h3 id="服务域-实体域-会话域分离"><a href="#服务域-实体域-会话域分离" class="headerlink" title="服务域/实体域/会话域分离"></a>服务域/实体域/会话域分离</h3><p>任何框架或组件，总会有核心领域模型，比如： Spring的Bean，Struts的Action，Dubbo的Service，Napoli的Queue等等<br>这个核心领域模型及其组成部分称为实体域，它代表着我们要操作的目标本身，<br>实体域通常是线程安全的，不管是通过不变类，同步状态，或复制的方式，<br>服务域也就是行为域，它是组件的功能集，同时也负责实体域和会话域的生命周期管理，<br>比如Spring的ApplicationContext，Dubbo的ServiceManager等， 服务域的对象通常会比较重，<br>而且是线程安全的，并以单一实例服务于所有调用， 什么是会话？就是一次交互过程，<br>会话中重要的概念是上下文，什么是上下文？ 比如我们说：“老地方见”，这里的“老地方”就是上下文信息，<br>为什么说“老地方”对方会知道，因为我们前面定义了“老地方”的具体内容， 所以说，上下文通常持有交互过程中的状态变量等，<br>会话对象通常较轻，每次请求都重新创建实例，请求结束后销毁。<br>简而言之： 把元信息交由实体域持有， 把一次请求中的临时状态由会话域持有， 由服务域贯穿整个过程。 </p>
<h3 id="在重要的过程上设置拦截接口"><a href="#在重要的过程上设置拦截接口" class="headerlink" title="在重要的过程上设置拦截接口"></a>在重要的过程上设置拦截接口</h3><p>如果你要写个远程调用框架，那远程调用的过程应该有一个统一的拦截接口，<br>如果你要写一个ORM框架，那至少SQL的执行过程，Mapping过程要有拦截接口，<br>如果你要写一个Web框架，那请求的执行过程应该要有拦截接口， 等等，<br>没有哪个公用的框架可以Cover住所有需求，允许外置行为，是框架的基本扩展方式， 这样，<br>如果有人想在远程调用前，验证下令牌，验证下黑白名单，统计下日志，<br>如果有人想在SQL执行前加下分页包装，做下数据权限控制，统计下SQL执行时间，<br>如果有人想在请求执行前检查下角色，包装下输入输出流，统计下请求量， 等等，<br>就可以自行完成，而不用侵入框架内部， 拦截接口，通常是把过程本身用一个对象封装起来，传给拦截器链，<br>比如：远程调用主过程为invoke()，那拦截器接口通常为invoke(Invocation)，<br>Invocation对象封装了本来要执行过程的上下文，并且Invocation里有一个invoke()方法，<br>由拦截器决定什么时候执行，同时，Invocation也代表拦截器行为本身，<br>这样上一拦截器的Invocation其实是包装的下一拦截器的过程，<br>直到最后一个拦截器的Invocation是包装的最终的invoke()过程，<br>同理，SQL主过程为execute()，那拦截器接口通常为execute(Execution)，原理一样， 当然，实现方式可以任意，上面只是举例。 </p>
<h3 id="重要的状态的变更发送事件并留出监听接口"><a href="#重要的状态的变更发送事件并留出监听接口" class="headerlink" title="重要的状态的变更发送事件并留出监听接口"></a>重要的状态的变更发送事件并留出监听接口</h3><p>这里先要讲一个事件和上面拦截器的区别，拦截器是干预过程的，它是过程的一部分，<br>是基于过程行为的， 而事件是基于状态数据的，任何行为改变的相同状态，对事件应该是一致的，<br>事件通常是事后通知，是一个Callback接口，方法名通常是过去式的，比如onChanged()，<br>比如远程调用框架，当网络断开或连上应该发出一个事件，当出现错误也可以考虑发出一个事件，<br>这样外围应用就有可能观察到框架内部的变化，做相应适应。 </p>
<h3 id="扩展接口职责尽可能单一，具有可组合性"><a href="#扩展接口职责尽可能单一，具有可组合性" class="headerlink" title="扩展接口职责尽可能单一，具有可组合性"></a>扩展接口职责尽可能单一，具有可组合性</h3><p>比如，远程调用框架它的协议是可以替换的， 如果只提供一个总的扩展接口，<br>当然可以做到切换协议， 但协议支持是可以细分为底层通讯，序列化，动态代理方式等等，<br>如果将接口拆细，正交分解，会更便于扩展者复用已有逻辑，而只是替换某部分实现策略， 当然这个分解的粒度需要把握好。 </p>
<h3 id="微核插件式，平等对待第三方"><a href="#微核插件式，平等对待第三方" class="headerlink" title="微核插件式，平等对待第三方"></a>微核插件式，平等对待第三方</h3><p>大凡发展的比较好的框架，都遵守微核的理念， Eclipse的微核是OSGi，<br>Spring的微核是BeanFactory，Maven的微核是Plexus， 通常核心是不应该带有功能性的，<br>而是一个生命周期和集成容器， 这样各功能可以通过相同的方式交互及扩展，<br>并且任何功能都可以被替换， 如果做不到微核，至少要平等对待第三方，<br>即原作者能实现的功能，扩展者应该可以通过扩展的方式全部做到，<br>原作者要把自己也当作扩展者，这样才能保证框架的可持续性及由内向外的稳定性。 </p>
<h3 id="不要控制外部对象的生命周期"><a href="#不要控制外部对象的生命周期" class="headerlink" title="不要控制外部对象的生命周期"></a>不要控制外部对象的生命周期</h3><p>比如上面说的Action使用接口和Renderer扩展接口， 框架如果让使用者或扩展者把Action或Renderer实现类的类名或类元信息报上来，<br>然后在内部通过反射newInstance()创建一个实例， 这样框架就控制了Action或Renderer实现类的生命周期，<br>Action或Renderer的生老病死，框架都自己做了，外部扩展或集成都无能为力，<br>好的办法是让使用者或扩展者把Action或Renderer实现类的实例报上来，<br>框架只是使用这些实例，这些对象是怎么创建的，怎么销毁的，都和框架无关， 框架最多提供工具类辅助管理，而不是绝对控制。 </p>
<h3 id="可配置一定可编程，并保持友好的CoC约定"><a href="#可配置一定可编程，并保持友好的CoC约定" class="headerlink" title="可配置一定可编程，并保持友好的CoC约定"></a>可配置一定可编程，并保持友好的CoC约定</h3><p>因为使用环境的不确定因素很多，框架总会有一些配置， 一般都会到classpath直扫某个指定名称的配置，<br>或者启动时允许指定配置路径， 做为一个通用框架，应该做到凡是能配置文件做的一定要能通过编程方式进行，<br>否则当使用者需要将你的框架与另一个框架集成时就会带来很多不必要的麻烦，<br>另外，尽可能做一个标准约定，如果用户按某种约定做事时，就不需要该配置项。<br>比如：配置模板位置，你可以约定，如果放在templates目录下就不用配了， 如果你想换个目录，就配置下。 </p>
<h3 id="区分命令与查询，明确前置条件与后置条件"><a href="#区分命令与查询，明确前置条件与后置条件" class="headerlink" title="区分命令与查询，明确前置条件与后置条件"></a>区分命令与查询，明确前置条件与后置条件</h3><p>这个是契约式设计的一部分，尽量遵守有返回值的方法是查询方法，void返回的方法是命令，<br>询方法通常是幂等性的，无副作用的，也就是不改变任何状态，调n次结果都是一样的，<br>比如get某个属性值，或查询一条数据库记录， 命令是指有副作用的，也就是会修改状态，<br>比如set某个值，或update某条数据库记录， 如果你的方法即做了修改状态的操作，又做了查询返回，<br>如果可能，将其拆成写读分离的两个方法， 比如：User deleteUser(id)，删除用户并返回被删除的用户，<br>考虑改为getUser()和void的deleteUser()。 另外，每个方法都尽量前置断言传入参数的合法性，后置断言返回结果的合法性，并文档化。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.206Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 读完 (大约 3643 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/为什么我们做分布式使用Redis/">为什么使用 Redis</a>
            
        </h1>
        <div class="content">
            <p>绝大部分写业务的程序员，在实际开发中使用 Redis 的时候，只会 Set Value 和 Get Value 两个操作，对 Redis 整体缺乏一个认知。这里对 Redis 常见问题做一个总结，解决大家的知识盲点。</p>
<h2 id="1、为什么使用-Redis"><a href="#1、为什么使用-Redis" class="headerlink" title="1、为什么使用 Redis"></a>1、为什么使用 Redis</h2><p>在项目中使用 Redis，主要考虑两个角度：性能和并发。如果只是为了分布式锁这些其他功能，还有其他中间件 Zookpeer 等代替，并非一定要使用 Redis。</p>
<h3 id="性能："><a href="#性能：" class="headerlink" title="性能："></a>性能：</h3><p>如下图所示，我们在碰到需要执行耗时特别久，且结果不频繁变动的 SQL，就特别适合将运行结果放入缓存。这样，后面的请求就去缓存中读取，使得请求能够迅速响应。</p>
<p>特别是在秒杀系统，在同一时间，几乎所有人都在点，都在下单。。。执行的是同一操作———向数据库查数据。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0929/090927_1b0c4b61_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<p>根据交互效果的不同，响应时间没有固定标准。在理想状态下，我们的页面跳转需要在瞬间解决，对于页内操作则需要在刹那间解决。</p>
<h3 id="并发："><a href="#并发：" class="headerlink" title="并发："></a>并发：</h3><p>如下图所示，在大并发的情况下，所有的请求直接访问数据库，数据库会出现连接异常。这个时候，就需要使用 Redis 做一个缓冲操作，让请求先访问到 Redis，而不是直接访问数据库。</p>
<p> <img src="https://images.gitee.com/uploads/images/2018/0929/090934_f875e978_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h3 id="使用-Redis-的常见问题"><a href="#使用-Redis-的常见问题" class="headerlink" title="使用 Redis 的常见问题"></a>使用 Redis 的常见问题</h3><ul>
<li><p>缓存和数据库双写一致性问题</p>
</li>
<li><p>缓存雪崩问题</p>
</li>
<li><p>缓存击穿问题</p>
</li>
<li><p>缓存的并发竞争问题</p>
</li>
</ul>
<h2 id="2、单线程的-Redis-为什么这么快"><a href="#2、单线程的-Redis-为什么这么快" class="headerlink" title="2、单线程的 Redis 为什么这么快"></a>2、单线程的 Redis 为什么这么快</h2><p>这个问题是对 Redis 内部机制的一个考察。很多人都不知道 Redis 是单线程工作模型。</p>
<h3 id="原因主要是以下三点："><a href="#原因主要是以下三点：" class="headerlink" title="原因主要是以下三点："></a>原因主要是以下三点：</h3><p>纯内存操作</p>
<p>单线程操作，避免了频繁的上下文切换</p>
<p>采用了非阻塞 I/O 多路复用机制</p>
<p>仔细说一说 I/O 多路复用机制，打一个比方：小名在 A 城开了一家快餐店店，负责同城快餐服务。小明因为资金限制，雇佣了一批配送员，然后小曲发现资金不够了，只够买一辆车送快递。</p>
<h3 id="经营方式一"><a href="#经营方式一" class="headerlink" title="经营方式一"></a>经营方式一</h3><p>客户每下一份订单，小明就让一个配送员盯着，然后让人开车去送。慢慢的小曲就发现了这种经营方式存在下述问题：</p>
<p>时间都花在了抢车上了，大部分配送员都处在闲置状态，抢到车才能去送。</p>
<p>随着下单的增多，配送员也越来越多，小明发现快递店里越来越挤，没办法雇佣新的配送员了。</p>
<p>配送员之间的协调很花时间。</p>
<p>综合上述缺点，小明痛定思痛，提出了经营方式二。</p>
<h3 id="经营方式二"><a href="#经营方式二" class="headerlink" title="经营方式二"></a>经营方式二</h3><p>小明只雇佣一个配送员。当客户下单，小明按送达地点标注好，依次放在一个地方。最后，让配送员依次开着车去送，送好了就回来拿下一个。上述两种经营方式对比，很明显第二种效率更高。</p>
<p>在上述比喻中：</p>
<p>每个配送员→每个线程</p>
<p>每个订单→每个 Socket(I/O 流)</p>
<p>订单的送达地点→Socket 的不同状态</p>
<p>客户送餐请求→来自客户端的请求</p>
<p>明曲的经营方式→服务端运行的代码</p>
<p>一辆车→CPU 的核数</p>
<p>于是有了如下结论：</p>
<p>经营方式一就是传统的并发模型，每个 I/O 流(订单)都有一个新的线程(配送员)管理。</p>
<p>经营方式二就是 I/O 多路复用。只有单个线程(一个配送员)，通过跟踪每个 I/O 流的状态(每个配送员的送达地点)，来管理多个 I/O 流。</p>
<p>下面类比到真实的 Redis 线程模型，如图所示：</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0929/090949_68d6f98f_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<p>Redis-client 在操作的时候，会产生具有不同事件类型的 Socket。在服务端，有一段 I/O 多路复用程序，将其置入队列之中。然后，文件事件分派器，依次去队列中取，转发到不同的事件处理器中。</p>
<h2 id="3、Redis-的数据类型及使用场景"><a href="#3、Redis-的数据类型及使用场景" class="headerlink" title="3、Redis 的数据类型及使用场景"></a>3、Redis 的数据类型及使用场景</h2><p>一个合格的程序员，这五种类型都会用到。</p>
<p>String</p>
<p>最常规的 set/get 操作，Value 可以是 String 也可以是数字。一般做一些复杂的计数功能的缓存。</p>
<p>Hash</p>
<p>这里 Value 存放的是结构化的对象，比较方便的就是操作其中的某个字段。我在做单点登录的时候，就是用这种数据结构存储用户信息，以 CookieId 作为 Key，设置 30 分钟为缓存过期时间，能很好的模拟出类似 Session 的效果。</p>
<p>List</p>
<p>使用 List 的数据结构，可以做简单的消息队列的功能。另外，可以利用 lrange 命令，做基于 Redis 的分页功能，性能极佳，用户体验好。</p>
<p>Set</p>
<p>因为 Set 堆放的是一堆不重复值的集合。所以可以做全局去重的功能。我们的系统一般都是集群部署，使用 JVM 自带的 Set 比较麻烦。另外，就是利用交集、并集、差集等操作，可以计算共同喜好，全部的喜好，自己独有的喜好等功能。</p>
<p>Sorted Set</p>
<p>Sorted Set 多了一个权重参数 Score，集合中的元素能够按 Score 进行排列。可以做排行榜应用，取 TOP N 操作。Sorted Set 可以用来做延时任务。</p>
<h2 id="4、Redis-的过期策略和内存淘汰机制"><a href="#4、Redis-的过期策略和内存淘汰机制" class="headerlink" title="4、Redis 的过期策略和内存淘汰机制"></a>4、Redis 的过期策略和内存淘汰机制</h2><p>Redis 是否用到家，从这就能看出来。比如你 Redis 只能存 5G 数据，可是你写了 10G，那会删 5G 的数据。怎么删的，这个问题思考过么？</p>
<p>正解：Redis 采用的是定期删除+惰性删除策略。</p>
<p>为什么不用定时删除策略</p>
<p>定时删除，用一个定时器来负责监视 Key，过期则自动删除。虽然内存及时释放，但是十分消耗 CPU 资源。在大并发请求下，CPU 要将时间应用在处理请求，而不是删除 Key，因此没有采用这一策略。</p>
<p>定期删除+惰性删除如何工作</p>
<p>定期删除，Redis 默认每个 100ms 检查，有过期 Key 则删除。需要说明的是，Redis 不是每个 100ms 将所有的 Key 检查一次，而是随机抽取进行检查。如果只采用定期删除策略，会导致很多 Key 到时间没有删除。于是，惰性删除派上用场。</p>
<p>采用定期删除+惰性删除就没其他问题了么</p>
<p>不是的，如果定期删除没删除掉 Key。并且你也没及时去请求 Key，也就是说惰性删除也没生效。这样，Redis 的内存会越来越高。那么就应该采用内存淘汰机制。</p>
<p>在 redis.conf 中有一行配置：</p>
<h1 id="maxmemory-policy-volatile-lru"><a href="#maxmemory-policy-volatile-lru" class="headerlink" title="maxmemory-policy volatile-lru"></a>maxmemory-policy volatile-lru</h1><p>该配置就是配内存淘汰策略的：</p>
<ul>
<li><p>noeviction：当内存不足以容纳新写入数据时，新写入操作会报错。</p>
</li>
<li><p>allkeys-lru：当内存不足以容纳新写入数据时，在键空间中，移除最近最少使用的 Key。（推荐使用，目前项目在用这种）(最近最久使用算法)</p>
</li>
<li><p>allkeys-random：当内存不足以容纳新写入数据时，在键空间中，随机移除某个 Key。（应该也没人用吧，你不删最少使用 Key，去随机删）</p>
</li>
<li><p>volatile-lru：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，移除最近最少使用的 Key。这种情况一般是把 Redis 既当缓存，又做持久化存储的时候才用。（不推荐）</p>
</li>
<li><p>volatile-random：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，随机移除某个 Key。（依然不推荐）</p>
</li>
<li><p>volatile-ttl：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，有更早过期时间的 Key 优先移除。（不推荐）</p>
</li>
</ul>
<h2 id="5、Redis-和数据库双写一致性问题"><a href="#5、Redis-和数据库双写一致性问题" class="headerlink" title="5、Redis 和数据库双写一致性问题"></a>5、Redis 和数据库双写一致性问题</h2><p>一致性问题还可以再分为最终一致性和强一致性。数据库和缓存双写，就必然会存在不一致的问题。前提是如果对数据有强一致性要求，不能放缓存。我们所做的一切，只能保证最终一致性。</p>
<p>另外，我们所做的方案从根本上来说，只能降低不一致发生的概率。因此，有强一致性要求的数据，不能放缓存。首先，采取正确更新策略，先更新数据库，再删缓存。其次，因为可能存在删除缓存失败的问题，提供一个补偿措施即可，例如利用消息队列。</p>
<h2 id="6、如何应对缓存穿透和缓存雪崩问题"><a href="#6、如何应对缓存穿透和缓存雪崩问题" class="headerlink" title="6、如何应对缓存穿透和缓存雪崩问题"></a>6、如何应对缓存穿透和缓存雪崩问题</h2><p>这两个问题，一般中小型传统软件企业很难碰到。如果有大并发的项目，流量有几百万左右，这两个问题一定要深刻考虑。缓存穿透，即黑客故意去请求缓存中不存在的数据，导致所有的请求都怼到数据库上，从而数据库连接异常。</p>
<h3 id="缓存穿透解决方案："><a href="#缓存穿透解决方案：" class="headerlink" title="缓存穿透解决方案："></a>缓存穿透解决方案：</h3><ul>
<li><p>利用互斥锁，缓存失效的时候，先去获得锁，得到锁了，再去请求数据库。没得到锁，则休眠一段时间重试。</p>
</li>
<li><p>采用异步更新策略，无论 Key 是否取到值，都直接返回。Value 值中维护一个缓存失效时间，缓存如果过期，异步起一个线程去读数据库，更新缓存。需要做缓存预热(项目启动前，先加载缓存)操作。</p>
</li>
<li><p>提供一个能迅速判断请求是否有效的拦截机制，比如，利用布隆过滤器，内部维护一系列合法有效的 Key。迅速判断出，请求所携带的 Key 是否合法有效。如果不合法，则直接返回。</p>
</li>
<li><p>缓存雪崩，即缓存同一时间大面积的失效，这个时候又来了一波请求，结果请求都怼到数据库上，从而导致数据库连接异常。</p>
</li>
</ul>
<h3 id="缓存雪崩解决方案："><a href="#缓存雪崩解决方案：" class="headerlink" title="缓存雪崩解决方案："></a>缓存雪崩解决方案：</h3><ul>
<li><p>给缓存的失效时间，加上一个随机值，避免集体失效。</p>
</li>
<li><p>使用互斥锁，但是该方案吞吐量明显下降了。</p>
</li>
<li><p>双缓存。我们有两个缓存，缓存 A 和缓存 B。缓存 A 的失效时间为 20 分钟，缓存 B 不设失效时间。自己做缓存预热操作。</p>
</li>
<li><p>然后细分以下几个小点：从缓存 A 读数据库，有则直接返回；A 没有数据，直接从 B 读数据，直接返回，并且异步启动一个更新线程，更新线程同时更新缓存 A 和缓存 B。</p>
</li>
</ul>
<h2 id="7、如何解决-Redis-的并发竞争-Key-问题"><a href="#7、如何解决-Redis-的并发竞争-Key-问题" class="headerlink" title="7、如何解决 Redis 的并发竞争 Key 问题"></a>7、如何解决 Redis 的并发竞争 Key 问题</h2><p>这个问题大致就是，同时有多个子系统去 Set 一个 Key。这个时候要注意什么呢？大家基本都是推荐用 Redis 事务机制。</p>
<p>但是我并不推荐使用 Redis 的事务机制。因为我们的生产环境，基本都是 Redis 集群环境，做了数据分片操作。你一个事务中有涉及到多个 Key 操作的时候，这多个 Key 不一定都存储在同一个 redis-server 上。因此，Redis 的事务机制，十分鸡肋。</p>
<h3 id="如果对这个-Key-操作，不要求顺序"><a href="#如果对这个-Key-操作，不要求顺序" class="headerlink" title="如果对这个 Key 操作，不要求顺序"></a>如果对这个 Key 操作，不要求顺序</h3><p>这种情况下，准备一个分布式锁，大家去抢锁，抢到锁就做 set 操作即可，比较简单。</p>
<h3 id="如果对这个-Key-操作，要求顺序"><a href="#如果对这个-Key-操作，要求顺序" class="headerlink" title="如果对这个 Key 操作，要求顺序"></a>如果对这个 Key 操作，要求顺序</h3><p>假设有一个 key1，系统 A 需要将 key1 设置为 valueA，系统 B 需要将 key1 设置为 valueB，系统 C 需要将 key1 设置为 valueC。</p>
<p>期望按照 key1 的 value 值按照 valueA &gt; valueB &gt; valueC 的顺序变化。这种时候我们在数据写入数据库的时候，需要保存一个时间戳。</p>
<h3 id="假设时间戳如下："><a href="#假设时间戳如下：" class="headerlink" title="假设时间戳如下："></a>假设时间戳如下：</h3><p>系统 A key 1 {valueA  3:00}<br>系统 B key 1 {valueB  3:05}<br>系统 C key 1 {valueC  3:10}</p>
<p>那么，假设系统 B 先抢到锁，将 key1 设置为{valueB 3:05}。接下来系统 A 抢到锁，发现自己的 valueA 的时间戳早于缓存中的时间戳，那就不做 set 操作了，以此类推。其他方法，比如利用队列，将 set 方法变成串行访问也可以。</p>
<h2 id="8、总结"><a href="#8、总结" class="headerlink" title="8、总结"></a>8、总结</h2><p>Redis 在国内各大公司都能看到其身影，比如我们熟悉的新浪，阿里，腾讯，百度，美团，小米等。学习 Redis，这几方面尤其重要：Redis 客户端、Redis 高级功能、Redis 持久化和开发运维常用问题探讨、Redis 复制的原理和优化策略、Redis 分布式解决方案等。</p>
<p>转自：<a href="https://www.cnblogs.com/yaodengyan/p/9717080.html" target="_blank" rel="noopener">https://www.cnblogs.com/yaodengyan/p/9717080.html</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.205Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 17 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Zookeeper/">Zookeeper</a>
            
        </h1>
        <div class="content">
            <p><img src="https://images.gitee.com/uploads/images/2018/0831/152702_53d9e530_87650.png" alt="输入图片说明" title="zookeeper.png"></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.202Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 分钟 读完 (大约 2485 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Dubbo知识精华-续/">Dubbo知识精华-2</a>
            
        </h1>
        <div class="content">
            <h4 id="1、了解Dubbo么？"><a href="#1、了解Dubbo么？" class="headerlink" title="1、了解Dubbo么？"></a>1、了解Dubbo么？</h4><p>Dubbo是阿里巴巴开源的基于 Java 的高性能 RPC 分布式服务框架，现已成为 Apache 基金会孵化项目。</p>
<p>官网：<a href="http://dubbo.apache.org" target="_blank" rel="noopener">http://dubbo.apache.org</a></p>
<h4 id="2、为什么要用Dubbo？"><a href="#2、为什么要用Dubbo？" class="headerlink" title="2、为什么要用Dubbo？"></a>2、为什么要用Dubbo？</h4><p>因为是阿里开源项目，国内很多互联网公司都在用，已经经过很多线上考验。内部使用了 Netty、Zookeeper，保证了高性能高可用性。</p>
<p>使用 Dubbo 可以将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，可用于提高业务复用灵活扩展，使前端应用能更快速的响应多变的市场需求。</p>
<p>下面这张图可以很清楚的诠释，最重要的一点是，分布式架构可以承受更大规模的并发流量。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091310_cddc13a2_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<p>下面是 Dubbo 的服务治理图。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091331_b0418750_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="3、Dubbo-和-Spring-Cloud-有什么区别？"><a href="#3、Dubbo-和-Spring-Cloud-有什么区别？" class="headerlink" title="3、Dubbo 和 Spring Cloud 有什么区别？"></a>3、Dubbo 和 Spring Cloud 有什么区别？</h4><p>两个没关联，如果硬要说区别，有以下几点。</p>
<p>1）通信方式不同</p>
<p>Dubbo 使用的是 RPC 通信，而 Spring Cloud 使用的是 HTTP RESTFul 方式。</p>
<p>2）组成部分不同</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091354_cbe8c962_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="4、dubbo都支持什么协议，推荐用哪种？"><a href="#4、dubbo都支持什么协议，推荐用哪种？" class="headerlink" title="4、dubbo都支持什么协议，推荐用哪种？"></a>4、dubbo都支持什么协议，推荐用哪种？</h4><p>dubbo://（推荐）</p>
<p>rmi://</p>
<p>hessian://</p>
<p>http://</p>
<p>webservice://</p>
<p>thrift://</p>
<p>memcached://</p>
<p>redis://</p>
<p>rest://</p>
<p>####/5、Dubbo需要 Web 容器吗？</p>
<p>不需要，如果硬要用 Web 容器，只会增加复杂性，也浪费资源。</p>
<h4 id="6、Dubbo内置了哪几种服务容器？"><a href="#6、Dubbo内置了哪几种服务容器？" class="headerlink" title="6、Dubbo内置了哪几种服务容器？"></a>6、Dubbo内置了哪几种服务容器？</h4><p>Spring Container</p>
<p>Jetty Container</p>
<p>Log4j Container</p>
<p>Dubbo 的服务容器只是一个简单的 Main 方法，并加载一个简单的 Spring 容器，用于暴露服务。</p>
<h4 id="7、Dubbo里面有哪几种节点角色？"><a href="#7、Dubbo里面有哪几种节点角色？" class="headerlink" title="7、Dubbo里面有哪几种节点角色？"></a>7、Dubbo里面有哪几种节点角色？</h4><p><img src="https://images.gitee.com/uploads/images/2018/1012/091452_fa47f6a4_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="8、画一画服务注册与发现的流程图"><a href="#8、画一画服务注册与发现的流程图" class="headerlink" title="8、画一画服务注册与发现的流程图"></a>8、画一画服务注册与发现的流程图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1012/091500_08e53014_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<p>该图来自 Dubbo 官网，供你参考，如果你说你熟悉 Dubbo, 面试官经常会让你画这个图，记好了。</p>
<h4 id="9、Dubbo默认使用什么注册中心，还有别的选择吗？"><a href="#9、Dubbo默认使用什么注册中心，还有别的选择吗？" class="headerlink" title="9、Dubbo默认使用什么注册中心，还有别的选择吗？"></a>9、Dubbo默认使用什么注册中心，还有别的选择吗？</h4><p>推荐使用 Zookeeper 作为注册中心，还有 Redis、Multicast、Simple 注册中心，但不推荐。</p>
<h4 id="10、Dubbo有哪几种配置方式？"><a href="#10、Dubbo有哪几种配置方式？" class="headerlink" title="10、Dubbo有哪几种配置方式？"></a>10、Dubbo有哪几种配置方式？</h4><p>1）Spring 配置方式<br>2）Java API 配置方式</p>
<h4 id="11、Dubbo-核心的配置有哪些？"><a href="#11、Dubbo-核心的配置有哪些？" class="headerlink" title="11、Dubbo 核心的配置有哪些？"></a>11、Dubbo 核心的配置有哪些？</h4><p>我曾经面试就遇到过面试官让你写这些配置，我也是蒙逼。。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091611_ae608c02_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<p>配置之间的关系见下图。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091630_3b2a0e41_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="12、在-Provider-上可以配置的-Consumer-端的属性有哪些？"><a href="#12、在-Provider-上可以配置的-Consumer-端的属性有哪些？" class="headerlink" title="12、在 Provider 上可以配置的 Consumer 端的属性有哪些？"></a>12、在 Provider 上可以配置的 Consumer 端的属性有哪些？</h4><p>1）timeout：方法调用超时<br>2）retries：失败重试次数，默认重试 2 次<br>3）loadbalance：负载均衡算法，默认随机<br>4）actives 消费者端，最大并发调用限制</p>
<h4 id="13、Dubbo启动时如果依赖的服务不可用会怎样？"><a href="#13、Dubbo启动时如果依赖的服务不可用会怎样？" class="headerlink" title="13、Dubbo启动时如果依赖的服务不可用会怎样？"></a>13、Dubbo启动时如果依赖的服务不可用会怎样？</h4><p>Dubbo 缺省会在启动时检查依赖的服务是否可用，不可用时会抛出异常，阻止 Spring 初始化完成，默认 check=”true”，可以通过 check=”false” 关闭检查。</p>
<h4 id="14、Dubbo推荐使用什么序列化框架，你知道的还有哪些？"><a href="#14、Dubbo推荐使用什么序列化框架，你知道的还有哪些？" class="headerlink" title="14、Dubbo推荐使用什么序列化框架，你知道的还有哪些？"></a>14、Dubbo推荐使用什么序列化框架，你知道的还有哪些？</h4><p>推荐使用Hessian序列化，还有Duddo、FastJson、Java自带序列化。</p>
<h4 id="15、Dubbo默认使用的是什么通信框架，还有别的选择吗？"><a href="#15、Dubbo默认使用的是什么通信框架，还有别的选择吗？" class="headerlink" title="15、Dubbo默认使用的是什么通信框架，还有别的选择吗？"></a>15、Dubbo默认使用的是什么通信框架，还有别的选择吗？</h4><p>Dubbo 默认使用 Netty 框架，也是推荐的选择，另外内容还集成有Mina、Grizzly。</p>
<h4 id="16、Dubbo有哪几种集群容错方案，默认是哪种？"><a href="#16、Dubbo有哪几种集群容错方案，默认是哪种？" class="headerlink" title="16、Dubbo有哪几种集群容错方案，默认是哪种？"></a>16、Dubbo有哪几种集群容错方案，默认是哪种？</h4><p><img src="https://images.gitee.com/uploads/images/2018/1012/091659_5a59aa66_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="17、Dubbo有哪几种负载均衡策略，默认是哪种？"><a href="#17、Dubbo有哪几种负载均衡策略，默认是哪种？" class="headerlink" title="17、Dubbo有哪几种负载均衡策略，默认是哪种？"></a>17、Dubbo有哪几种负载均衡策略，默认是哪种？</h4><p><img src="https://images.gitee.com/uploads/images/2018/1012/091705_af4a9144_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="18、注册了多个同一样的服务，如果测试指定的某一个服务呢？"><a href="#18、注册了多个同一样的服务，如果测试指定的某一个服务呢？" class="headerlink" title="18、注册了多个同一样的服务，如果测试指定的某一个服务呢？"></a>18、注册了多个同一样的服务，如果测试指定的某一个服务呢？</h4><p>可以配置环境点对点直连，绕过注册中心，将以服务接口为单位，忽略注册中心的提供者列表。</p>
<h4 id="19、Dubbo支持服务多协议吗？"><a href="#19、Dubbo支持服务多协议吗？" class="headerlink" title="19、Dubbo支持服务多协议吗？"></a>19、Dubbo支持服务多协议吗？</h4><p>Dubbo 允许配置多协议，在不同服务上支持不同协议或者同一服务上同时支持多种协议。</p>
<h4 id="20、当一个服务接口有多种实现时怎么做？"><a href="#20、当一个服务接口有多种实现时怎么做？" class="headerlink" title="20、当一个服务接口有多种实现时怎么做？"></a>20、当一个服务接口有多种实现时怎么做？</h4><p>当一个接口有多种实现时，可以用 group 属性来分组，服务提供方和消费方都指定同一个 group 即可。</p>
<h4 id="21、服务上线怎么兼容旧版本？"><a href="#21、服务上线怎么兼容旧版本？" class="headerlink" title="21、服务上线怎么兼容旧版本？"></a>21、服务上线怎么兼容旧版本？</h4><p>可以用版本号（version）过渡，多个不同版本的服务注册到注册中心，版本号不同的服务相互间不引用。这个和服务分组的概念有一点类似。</p>
<h4 id="22、Dubbo可以对结果进行缓存吗？"><a href="#22、Dubbo可以对结果进行缓存吗？" class="headerlink" title="22、Dubbo可以对结果进行缓存吗？"></a>22、Dubbo可以对结果进行缓存吗？</h4><p>可以，Dubbo 提供了声明式缓存，用于加速热门数据的访问速度，以减少用户加缓存的工作量。</p>
<h4 id="23、Dubbo服务之间的调用是阻塞的吗？"><a href="#23、Dubbo服务之间的调用是阻塞的吗？" class="headerlink" title="23、Dubbo服务之间的调用是阻塞的吗？"></a>23、Dubbo服务之间的调用是阻塞的吗？</h4><p>默认是同步等待结果阻塞的，支持异步调用。</p>
<p>Dubbo 是基于 NIO 的非阻塞实现并行调用，客户端不需要启动多线程即可完成并行调用多个远程服务，相对多线程开销较小，异步调用会返回一个 Future 对象。</p>
<p>异步调用流程图如下。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091746_e678a0d8_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="24、Dubbo支持分布式事务吗？"><a href="#24、Dubbo支持分布式事务吗？" class="headerlink" title="24、Dubbo支持分布式事务吗？"></a>24、Dubbo支持分布式事务吗？</h4><p>目前暂时不支持，后续可能采用基于 JTA/XA 规范实现，如以图所示。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/1012/091756_c686ae87_87650.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h4 id="25、Dubbo-telnet-命令能做什么？"><a href="#25、Dubbo-telnet-命令能做什么？" class="headerlink" title="25、Dubbo telnet 命令能做什么？"></a>25、Dubbo telnet 命令能做什么？</h4><p>dubbo 通过 telnet 命令来进行服务治理，具体使用看这篇文章《dubbo服务调试管理实用命令》。</p>
<p>telnet localhost 8090</p>
<h4 id="26、Dubbo支持服务降级吗？"><a href="#26、Dubbo支持服务降级吗？" class="headerlink" title="26、Dubbo支持服务降级吗？"></a>26、Dubbo支持服务降级吗？</h4><p>Dubbo 2.2.0 以上版本支持。</p>
<h4 id="27、Dubbo如何优雅停机？"><a href="#27、Dubbo如何优雅停机？" class="headerlink" title="27、Dubbo如何优雅停机？"></a>27、Dubbo如何优雅停机？</h4><p>Dubbo 是通过 JDK 的 ShutdownHook 来完成优雅停机的，所以如果使用 kill -9 PID 等强制关闭指令，是不会执行优雅停机的，只有通过 kill PID 时，才会执行。</p>
<h4 id="28、服务提供者能实现失效踢出是什么原理？"><a href="#28、服务提供者能实现失效踢出是什么原理？" class="headerlink" title="28、服务提供者能实现失效踢出是什么原理？"></a>28、服务提供者能实现失效踢出是什么原理？</h4><p>服务失效踢出基于 Zookeeper 的临时节点原理。</p>
<h4 id="29、如何解决服务调用链过长的问题？"><a href="#29、如何解决服务调用链过长的问题？" class="headerlink" title="29、如何解决服务调用链过长的问题？"></a>29、如何解决服务调用链过长的问题？</h4><p>Dubbo 可以使用 Pinpoint 和 Apache Skywalking(Incubator) 实现分布式服务追踪，当然还有其他很多方案。</p>
<h4 id="30、服务读写推荐的容错策略是怎样的？"><a href="#30、服务读写推荐的容错策略是怎样的？" class="headerlink" title="30、服务读写推荐的容错策略是怎样的？"></a>30、服务读写推荐的容错策略是怎样的？</h4><p>读操作建议使用 Failover 失败自动切换，默认重试两次其他服务器。</p>
<p>写操作建议使用 Failfast 快速失败，发一次调用失败就立即报错。</p>
<h4 id="31、Dubbo必须依赖的包有哪些？"><a href="#31、Dubbo必须依赖的包有哪些？" class="headerlink" title="31、Dubbo必须依赖的包有哪些？"></a>31、Dubbo必须依赖的包有哪些？</h4><p>Dubbo 必须依赖 JDK，其他为可选。</p>
<h4 id="32、Dubbo的管理控制台能做什么？"><a href="#32、Dubbo的管理控制台能做什么？" class="headerlink" title="32、Dubbo的管理控制台能做什么？"></a>32、Dubbo的管理控制台能做什么？</h4><p>管理控制台主要包含：路由规则，动态配置，服务降级，访问控制，权重调整，负载均衡，等管理功能。</p>
<h4 id="33、说说-Dubbo-服务暴露的过程。"><a href="#33、说说-Dubbo-服务暴露的过程。" class="headerlink" title="33、说说 Dubbo 服务暴露的过程。"></a>33、说说 Dubbo 服务暴露的过程。</h4><p>Dubbo 会在 Spring 实例化完 bean 之后，在刷新容器最后一步发布 ContextRefreshEvent 事件的时候，通知实现了 ApplicationListener 的 ServiceBean 类进行回调 onApplicationEvent 事件方法，Dubbo 会在这个方法中调用 ServiceBean 父类 ServiceConfig 的 export 方法，而该方法真正实现了服务的（异步或者非异步）发布。</p>
<h4 id="34、Dubbo-停止维护了吗？"><a href="#34、Dubbo-停止维护了吗？" class="headerlink" title="34、Dubbo 停止维护了吗？"></a>34、Dubbo 停止维护了吗？</h4><p>2014 年开始停止维护过几年，17 年开始重新维护，并进入了 Apache 项目。</p>
<h4 id="35、Dubbo-和-Dubbox-有什么区别？"><a href="#35、Dubbo-和-Dubbox-有什么区别？" class="headerlink" title="35、Dubbo 和 Dubbox 有什么区别？"></a>35、Dubbo 和 Dubbox 有什么区别？</h4><p>Dubbox 是继 Dubbo 停止维护后，当当网基于 Dubbo 做的一个扩展项目，如加了服务可 Restful 调用，更新了开源组件等。</p>
<p>Dubbo 2.6.1 是改变结构后首次发布的版本，Dubbo 2.6.0 已合并当当网提供的 Dubbox 分支。</p>
<p>Dubbo的版本策略：两个大版本并行发展，2.5.x是稳定版本，2.6.x是新功能实验版本。2.6上实验都稳定了以后，会迁移到2.5。</p>
<h4 id="36、你还了解别的分布式框架吗？"><a href="#36、你还了解别的分布式框架吗？" class="headerlink" title="36、你还了解别的分布式框架吗？"></a>36、你还了解别的分布式框架吗？</h4><p>别的还有 Spring cloud、Facebook 的 Thrift、Twitter 的 Finagle 等。</p>
<h4 id="37、Dubbo-能集成-Spring-Boot-吗？"><a href="#37、Dubbo-能集成-Spring-Boot-吗？" class="headerlink" title="37、Dubbo 能集成 Spring Boot 吗？"></a>37、Dubbo 能集成 Spring Boot 吗？</h4><p>可以的，项目地址如下。</p>
<p><a href="https://github.com/apache/incubator-dubbo-spring-boot-project" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo-spring-boot-project</a></p>
<h4 id="38、在使用过程中都遇到了些什么问题？"><a href="#38、在使用过程中都遇到了些什么问题？" class="headerlink" title="38、在使用过程中都遇到了些什么问题？"></a>38、在使用过程中都遇到了些什么问题？</h4><p>Dubbo 的设计目的是为了满足高并发小数据量的 rpc 调用，在大数据量下的性能表现并不好，建议使用 rmi 或 http 协议。</p>
<h4 id="39、你读过-Dubbo-的源码吗？"><a href="#39、你读过-Dubbo-的源码吗？" class="headerlink" title="39、你读过 Dubbo 的源码吗？"></a>39、你读过 Dubbo 的源码吗？</h4><p>要了解 Dubbo 就必须看其源码，了解其原理，花点时间看下吧，网上也有很多教程，后续有时间我也会在公众号上分享 Dubbo 的源码。</p>
<h4 id="40、你觉得用-Dubbo-好还是-Spring-Cloud-好？"><a href="#40、你觉得用-Dubbo-好还是-Spring-Cloud-好？" class="headerlink" title="40、你觉得用 Dubbo 好还是 Spring Cloud 好？"></a>40、你觉得用 Dubbo 好还是 Spring Cloud 好？</h4><p>扩展性的问题，没有好坏，只有适合不适合，不过我好像更倾向于使用 Dubbo, Spring Cloud 版本升级太快，组件更新替换太频繁，配置太繁琐，还有很多我觉得是没有 Dubbo 顺手的地方……</p>
<h2 id="Java技术栈"><a href="#Java技术栈" class="headerlink" title="Java技术栈"></a>Java技术栈</h2>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.200Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 分钟 读完 (大约 785 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Dubbo知识精华/">Dubbo知识精华</a>
            
        </h1>
        <div class="content">
            <h4 id="1、默认使用的是什么通信框架，还有别的选择吗"><a href="#1、默认使用的是什么通信框架，还有别的选择吗" class="headerlink" title="1、默认使用的是什么通信框架，还有别的选择吗?"></a>1、默认使用的是什么通信框架，还有别的选择吗?</h4><p>默认也推荐使用netty框架，还有mina。</p>
<h4 id="2、服务调用是阻塞的吗？"><a href="#2、服务调用是阻塞的吗？" class="headerlink" title="2、服务调用是阻塞的吗？"></a>2、服务调用是阻塞的吗？</h4><p>默认是阻塞的，可以异步调用，没有返回值的可以这么做。</p>
<h4 id="3、一般使用什么注册中心？还有别的选择吗？"><a href="#3、一般使用什么注册中心？还有别的选择吗？" class="headerlink" title="3、一般使用什么注册中心？还有别的选择吗？"></a>3、一般使用什么注册中心？还有别的选择吗？</h4><p>推荐使用zookeeper注册中心，还有redis等不推荐。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0831/153501_9a059fcf_87650.png" alt="输入图片说明" title="SPI.png"></p>
<h4 id="4、默认使用什么序列化框架，你知道的还有哪些？"><a href="#4、默认使用什么序列化框架，你知道的还有哪些？" class="headerlink" title="4、默认使用什么序列化框架，你知道的还有哪些？"></a>4、默认使用什么序列化框架，你知道的还有哪些？</h4><p>默认使用Hessian序列化，还有Duddo、FastJson、Java自带序列化。</p>
<h4 id="5、服务提供者能实现失效踢出是什么原理？"><a href="#5、服务提供者能实现失效踢出是什么原理？" class="headerlink" title="5、服务提供者能实现失效踢出是什么原理？"></a>5、服务提供者能实现失效踢出是什么原理？</h4><p>服务失效踢出基于zookeeper的临时节点原理。</p>
<h4 id="6、服务上线怎么不影响旧版本？"><a href="#6、服务上线怎么不影响旧版本？" class="headerlink" title="6、服务上线怎么不影响旧版本？"></a>6、服务上线怎么不影响旧版本？</h4><p>采用多版本开发，不影响旧版本。</p>
<h4 id="7、如何解决服务调用链过长的问题？"><a href="#7、如何解决服务调用链过长的问题？" class="headerlink" title="7、如何解决服务调用链过长的问题？"></a>7、如何解决服务调用链过长的问题？</h4><p>可以结合zipkin实现分布式服务追踪。</p>
<h4 id="8、说说核心的配置有哪些？"><a href="#8、说说核心的配置有哪些？" class="headerlink" title="8、说说核心的配置有哪些？"></a>8、说说核心的配置有哪些？</h4><p>核心配置有</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dubbo:service/</span><br><span class="line"></span><br><span class="line">dubbo:reference/</span><br><span class="line"></span><br><span class="line">dubbo:protocol/</span><br><span class="line"></span><br><span class="line">dubbo:registry/</span><br><span class="line"></span><br><span class="line">dubbo:application/</span><br><span class="line"></span><br><span class="line">dubbo:provider/</span><br><span class="line"></span><br><span class="line">dubbo:consumer/</span><br><span class="line"></span><br><span class="line">dubbo:method/</span><br></pre></td></tr></table></figure>

<h4 id="9、dubbo推荐用什么协议？"><a href="#9、dubbo推荐用什么协议？" class="headerlink" title="9、dubbo推荐用什么协议？"></a>9、dubbo推荐用什么协议？</h4><p>默认使用dubbo协议。</p>
<h4 id="10、同一个服务多个注册的情况下可以直连某一个服务吗？"><a href="#10、同一个服务多个注册的情况下可以直连某一个服务吗？" class="headerlink" title="10、同一个服务多个注册的情况下可以直连某一个服务吗？"></a>10、同一个服务多个注册的情况下可以直连某一个服务吗？</h4><p>可以直连，修改配置即可，也可以通过telnet直接某个服务。</p>
<h4 id="11、Dubbo集群容错怎么做？"><a href="#11、Dubbo集群容错怎么做？" class="headerlink" title="11、Dubbo集群容错怎么做？"></a>11、Dubbo集群容错怎么做？</h4><p>读操作建议使用Failover失败自动切换，默认重试两次其他服务器。写操作建议使用Failfast快速失败，发一次调用失败就立即报错。</p>
<h4 id="12、dubbo和dubbox之间的区别？"><a href="#12、dubbo和dubbox之间的区别？" class="headerlink" title="12、dubbo和dubbox之间的区别？"></a>12、dubbo和dubbox之间的区别？</h4><p>dubbox是当当网基于dubbo上做了一些扩展，如加了服务可restful调用，更新了开源组件等。</p>
<h4 id="13、你还了解别的分布式框架吗？"><a href="#13、你还了解别的分布式框架吗？" class="headerlink" title="13、你还了解别的分布式框架吗？"></a>13、你还了解别的分布式框架吗？</h4><p>别的还有spring的spring cloud，facebook的thrift，twitter的finagle等。</p>
<h4 id="14、dubbo中zookeeper做注册中心，如果注册中心集群都挂掉，那发布者和订阅者还能通信吗"><a href="#14、dubbo中zookeeper做注册中心，如果注册中心集群都挂掉，那发布者和订阅者还能通信吗" class="headerlink" title="14、dubbo中zookeeper做注册中心，如果注册中心集群都挂掉，那发布者和订阅者还能通信吗?"></a>14、dubbo中zookeeper做注册中心，如果注册中心集群都挂掉，那发布者和订阅者还能通信吗?</h4><p>可以的，zookeeper的信息会缓存到本地作为一个缓存文件，并且转换成properties对象方便使用。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用zookeeper注册中心暴露服务地址 subscribe 默认：true 是否向此注册中心订阅服务，如果设为false，将只注册，不订阅 check 默认：true 注册中心不存在时，是否报错    --&gt;</span><br><span class="line">&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;$&#123;dubbo.registry.address&#125;&quot; file=&quot;$&#123;dubbo.registry.file&#125;&quot; check=&quot;false&quot;/&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dubbo.registry.address=172.16.1.130:2181,172.16.1.133:2181,172.16.1.120:2181</span><br><span class="line">dubbo.registry.file=/root/.dubbo/pay/dubbo.cache</span><br></pre></td></tr></table></figure>

<h4 id="15、项目中有使用过多线程吗-有的话讲讲你在哪里用到了多线程"><a href="#15、项目中有使用过多线程吗-有的话讲讲你在哪里用到了多线程" class="headerlink" title="15、项目中有使用过多线程吗?有的话讲讲你在哪里用到了多线程?"></a>15、项目中有使用过多线程吗?有的话讲讲你在哪里用到了多线程?</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line">  生产者配置 生产者  远程默认调用3次 参数 retries=&quot;2&quot; async=&quot;true&quot; 异步返回结果 默认是同步 timeout=&quot;10000&quot; 毫秒</span><br><span class="line">  用dubbo协议在20882端口暴露服务  固定线程池 10 启动时建立线程，不关闭，一直持有  负载均衡策略 轮询</span><br><span class="line">	 --&gt;</span><br><span class="line">&lt;dubbo:provider  timeout=&quot;10000&quot;  threads=&quot;10&quot; threadpool=&quot;fixed&quot; loadbalance=&quot;roundrobin&quot;/&gt;</span><br></pre></td></tr></table></figure>

<h4 id="16、Zookeeper的Java客户端你使用过哪些"><a href="#16、Zookeeper的Java客户端你使用过哪些" class="headerlink" title="16、Zookeeper的Java客户端你使用过哪些?"></a>16、Zookeeper的Java客户端你使用过哪些?</h4><p><img src="https://images.gitee.com/uploads/images/2018/0831/154522_65ef08bd_87650.png" alt="输入图片说明" title="Zk.png"></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.197Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 98 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Dubbo相关文档/"></a>
            
        </h1>
        <div class="content">
            <h4 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h4><p><a href="http://dubbo.apache.org/zh-cn/index.html" target="_blank" rel="noopener">http://dubbo.apache.org/zh-cn/index.html</a></p>
<h4 id="中文文档"><a href="#中文文档" class="headerlink" title="中文文档"></a>中文文档</h4><p><a href="http://dubbo.apache.org/zh-cn/docs/user/quick-start.html" target="_blank" rel="noopener">http://dubbo.apache.org/zh-cn/docs/user/quick-start.html</a></p>
<h4 id="apache孵化中心"><a href="#apache孵化中心" class="headerlink" title="apache孵化中心"></a>apache孵化中心</h4><p><a href="https://github.com/apache/incubator-dubbo" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo</a></p>
<h4 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h4><p><a href="http://dubbo.apache.org/zh-cn/blog/download.html" target="_blank" rel="noopener">http://dubbo.apache.org/zh-cn/blog/download.html</a></p>
<h4 id="Maven库"><a href="#Maven库" class="headerlink" title="Maven库"></a>Maven库</h4><p><a href="https://mvnrepository.com/artifact/com.alibaba/dubbo" target="_blank" rel="noopener">https://mvnrepository.com/artifact/com.alibaba/dubbo</a></p>
<h4 id="dubbo-spring-boot-project"><a href="#dubbo-spring-boot-project" class="headerlink" title="dubbo-spring-boot-project"></a>dubbo-spring-boot-project</h4><p><a href="https://github.com/apache/incubator-dubbo-spring-boot-project" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo-spring-boot-project</a></p>
<p><a href="https://github.com/alibaba/dubbo-spring-boot-starter" target="_blank" rel="noopener">https://github.com/alibaba/dubbo-spring-boot-starter</a> (废弃、迁移)</p>
<h4 id="Dubbox"><a href="#Dubbox" class="headerlink" title="Dubbox"></a>Dubbox</h4><p><a href="https://github.com/dangdangdotcom/dubbox" target="_blank" rel="noopener">https://github.com/dangdangdotcom/dubbox</a></p>
<h4 id="Dubbox文档"><a href="#Dubbox文档" class="headerlink" title="Dubbox文档"></a>Dubbox文档</h4><p><a href="https://dangdangdotcom.github.io/dubbox/" target="_blank" rel="noopener">https://dangdangdotcom.github.io/dubbox/</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.195Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分钟 读完 (大约 1096 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Dubbo/">Dubbo</a>
            
        </h1>
        <div class="content">
            <h3 id="【什么是-dubbo】"><a href="#【什么是-dubbo】" class="headerlink" title="【什么是 dubbo】"></a>【什么是 dubbo】</h3><p>Dubbo 是阿里巴巴开发用来用来治理服务中间件，资源调度和治理中心的管理工具。</p>
<h3 id="【ZooKeeper-节点类型】"><a href="#【ZooKeeper-节点类型】" class="headerlink" title="【ZooKeeper 节点类型】"></a>【ZooKeeper 节点类型】</h3><p>ZooKeeper 节点是有生命周期的，这取决于节点的类型，在 ZooKeeper 中，节点类型可以分为：</p>
<ul>
<li>持久节点（PERSISTENT ）<br>是指在节点创建后，就一直存在，直到有删除操作来主动清除这个节点</li>
<li>临时节点（EPHEMERAL）<br>临时节点的生命周期和客户端会话绑定。如果客户端会话失效，那么这个节点就会自动被清除掉。在临时节点下面不能创建子节点。</li>
<li>持久顺序节点（PERSISTENT_SEQUENTIAL）<br>在持久节点的基础上，在ZK中，每个父节点会为他的第一级子节点维护一份时序，会记录每个子节点创建的先后顺序</li>
<li>临时顺序节点（EPHEMERAL_SEQUENTIAL）<br>可以用来实现分布式锁【<a href="https://blog.52itstyle.com/archives/3202/" title="从构建分布式秒杀系统聊聊分布式锁" target="_blank" rel="noopener">从构建分布式秒杀系统聊聊分布式锁</a>】</li>
</ul>
<h3 id="【dubbo节点角色说明】"><a href="#【dubbo节点角色说明】" class="headerlink" title="【dubbo节点角色说明】"></a>【dubbo节点角色说明】</h3><ul>
<li>Provider: 暴露服务的服务提供方（service 服务层）。</li>
<li>Consumer: 调用远程服务的服务消费方(web 表现层)。</li>
<li>Registry: 服务注册与发现的注册中心（zookeeper）。</li>
<li>Monitor: 统计服务的调用次调和调用时间的监控中心。</li>
<li>Container: 服务运行容器(tomcat 容器，spring 容器)。</li>
</ul>
<h3 id="【dubbo的注册原理】zookeeper流程"><a href="#【dubbo的注册原理】zookeeper流程" class="headerlink" title="【dubbo的注册原理】zookeeper流程"></a>【dubbo的注册原理】zookeeper流程</h3><ul>
<li>服务提供者启动时向/dubbo/com.foo.BarService/providers 目录下写入自己的 URL 地址。</li>
<li>服务消费者启动时订阅/dubbo/com.foo.BarService/providers 目录下的提供者 URL 地址。</li>
<li>并向/dubbo/com.foo.BarService/consumers 目录下写入自己的 URL 地址。</li>
<li>监控中心启动时订阅/dubbo/com.foo.BarService 目录下的所有提供者和消费者 URL 地址。</li>
</ul>
<h3 id="【注册中心包括】"><a href="#【注册中心包括】" class="headerlink" title="【注册中心包括】"></a>【注册中心包括】</h3><ul>
<li>Multicast 注册中心不需要启动任何中心节点，只要广播地址一样，就可以互相发现。</li>
<li>Zookeeper 是 Apacahe Hadoop 的子项目，是一个树型的目录服务，支持变更推送，适合作为 Dubbo 服务的注册中心，工业强度较高，可用于生产环境，并推荐使用</li>
<li>基于 Redis 实现的注册中心 </li>
<li>Simple 注册中心本身就是一个普通的 Dubbo 服务，可以减少第三方依赖，使整体通讯方式一致。</li>
</ul>
<h3 id="【dubbo-zookeeper流程-从生产者到消费者】"><a href="#【dubbo-zookeeper流程-从生产者到消费者】" class="headerlink" title="【dubbo,zookeeper流程,从生产者到消费者】"></a>【dubbo,zookeeper流程,从生产者到消费者】</h3><ul>
<li>生产者和消费者都要进行dubbo的配置 ,都需要注册zookeeper主机地址,</li>
<li>生产者要配置dubbo使用的协议(默认dubbo)和端口号用来暴露服务,</li>
<li>生产者定义接口和实现类,并在配置文件中进行注册服务,</li>
<li>生产者启动时会自动把注册的接口的信息转化为一个url,</li>
<li>并通过hessian二进制序列化存储到zookeeper的节点中</li>
<li>消费者在配置文件中引入要使用的服务接口,</li>
<li>消费者启动时会从zookeeper中获取与引用的接口匹配的url,</li>
<li>并把自己的信息留在zookeeper中</li>
<li>服务者和消费者在zookeeper中的信息都会被监控中心monitor获取到,</li>
<li>可以通过monitor服务对zookeeper中的内容进行管理</li>
</ul>
<h3 id="【服务的配置】"><a href="#【服务的配置】" class="headerlink" title="【服务的配置】"></a>【服务的配置】</h3><figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!--【服务者】 给服务起一个名称,唯一标识,用来监控服务器调用关系,调用次数 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:application</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"provider"</span> /&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 使用dubbo官方推荐注册中心模式注册对象 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:registry</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"zookeeper://192.168.1.180:2181"</span> /&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 用dubbo协议在20880端口暴露服务 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:protocol</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dubbo"</span> <span class="hljs-attr">port</span>=<span class="hljs-string">"20880"</span> /&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 发布服务:itemService 注册对象,通过接口来注册对象 --&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 和本地bean一样实现服务 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"xxx.xxx.xxx.XxxImpl"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"xxx.xxx.xxx.XxxImpl"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:service</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">"xxx.xxx.xxx.Ixxx"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"xxxImpl"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">&lt;!-- 【消费者】给服务起一个名称,唯一标识,用来监控服务器调用关系,调用次数 --&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 消费方应用名，用于计算依赖关系，不是匹配条件，不要与提供方一样 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:application</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"consumer"</span> /&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 使用multicast广播注册中心暴露发现服务地址 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:registry</span> <span class="hljs-attr">address</span>=<span class="hljs-string">"zookeeper://192.168.17.129:2181"</span> /&gt;</span></span><br><span class="line"><span class="hljs-comment">&lt;!-- 生成远程服务代理，可以和本地bean一样使用itemService --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"xxx"</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">"xxx.xxx.xxx.Ixxx"</span> <span class="hljs-attr">timeout</span>=<span class="hljs-string">"1000000"</span> <span class="hljs-attr">retries</span>=<span class="hljs-string">"2"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h3><p><a href="http://dubbo.apache.org/zh-cn/docs/dev/design.html" target="_blank" rel="noopener">http://dubbo.apache.org/zh-cn/docs/dev/design.html</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:54.193Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 分钟 读完 (大约 716 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/知识图谱/">知识图谱</a>
            
        </h1>
        <div class="content">
            <p><img src="https://images.gitee.com/uploads/images/2018/0829/150425_9e6a9814_87650.jpeg" alt="输入图片说明" title="1.jpg"></p>
<h2 id="阅读源码"><a href="#阅读源码" class="headerlink" title="阅读源码"></a>阅读源码</h2><p>阅读、分析源码是程序员最基本的码代码能力也是码农的根本所在，学习经典源码中所用到的经典设计思想及常用设计模式，能够帮你了解大牛是如何<br>写代码的，从而吸收大牛的代码功力。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150436_7a6cc8a1_87650.jpeg" alt="输入图片说明" title="2.jpg"></p>
<h2 id="分布式架构"><a href="#分布式架构" class="headerlink" title="分布式架构"></a>分布式架构</h2><p>阿里巴巴有很多大团队，这种大团队里有很多小团队，到小团队之后，做的业务都不相同，如果想立足成为一线互联网公司中的万能选手，最主流的<br>分布式架构中有很多知识都是必须要去了解与学习的。并且在阿里面试过程中，面试官会问到实际应用场景的问题：比如微服务化、用户量、并发量<br>、业务复杂度以及可扩展程度等，这里不多赘述。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150442_58903af9_87650.jpeg" alt="输入图片说明" title="3.jpg"></p>
<h2 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h2><p>微服务是现在互联网架构技术中最火热的话题之一，作为一名开发者，一名有技术梦想的程序员微服务架构是现在必须要去了解的主流技术。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150448_60e9803b_87650.jpeg" alt="输入图片说明" title="4.jpg"></p>
<h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><p>并发编程几乎是所有互联网公司面试必问问题，并发编程是Java程序员最重要的技能之一，也是最难掌握的一种技能。它要求编程者对计算机最底层<br>的运作原理有深刻的理解，同时要求编程者逻辑清晰、思维缜密，这样才能写出高效、安全、可靠的多线程并发程序。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150454_5ee83c26_87650.jpeg" alt="输入图片说明" title="5.jpg"></p>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>性能一直是让程序员比较头疼的问题。当系统架构变得复杂而庞大之后，性能方面就会下降，特别是阿里巴巴这样的一线互联网公司最为注重，因此想<br>进入阿里，性能优化一定是要去深入学习与理解的一环。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150500_4f65a1ba_87650.jpeg" alt="输入图片说明" title="6.jpg"></p>
<h2 id="Java开发工具"><a href="#Java开发工具" class="headerlink" title="Java开发工具"></a>Java开发工具</h2><p>一名开发人员必须有适合自己的兵器，也就是工欲善其事必先利其器，不管是小白，还是资深开发，都需要先选择好的工具。</p>
<p><img src="https://images.gitee.com/uploads/images/2018/0829/150506_2fa6e158_87650.jpeg" alt="输入图片说明" title="7.jpg"></p>
<p>更多IT架构师技术知识图谱：<a href="http://file.52itstyle.com" target="_blank" rel="noopener">http://file.52itstyle.com</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-30T06:23:36.117Z">2019-07-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分钟 读完 (大约 1548 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/30/Tomcat最佳实践/">Tomcat实践</a>
            
        </h1>
        <div class="content">
            <h2 id="运行模式"><a href="#运行模式" class="headerlink" title="运行模式"></a>运行模式</h2><p>Tomcat Connector三种运行模式（BIO, NIO, APR）的比较和优化。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.apache.coyote.http11.Http11Protocol：BIO</span><br><span class="line">org.apache.coyote.http11.Http11NioProtocol：NIO</span><br><span class="line">org.apache.coyote.http11.Http11Nio2Protocol：NIO2</span><br><span class="line">org.apache.coyote.http11.Http11AprProtocol：APR</span><br></pre></td></tr></table></figure>

<h3 id="BIO"><a href="#BIO" class="headerlink" title="BIO"></a>BIO</h3><p>一个线程处理一个请求。缺点：并发量高时，线程数较多，浪费资源。Tomcat7或以下，在Linux系统中默认使用这种方式。</p>
<h3 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h3><p>利用Java的异步IO处理，可以通过少量的线程处理大量的请求。Tomcat8在Linux系统中默认使用这种方式。Tomcat7必须修改Connector配置来启动：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span> </span></span><br><span class="line"><span class="hljs-tag">           <span class="hljs-attr">protocol</span>=<span class="hljs-string">"org.apache.coyote.http11.Http11NioProtocol"</span></span></span><br><span class="line"><span class="hljs-tag">           <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span></span></span><br><span class="line"><span class="hljs-tag">		   <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>Tomcat8以后NIO2模式：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span>  <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">protocol</span>=<span class="hljs-string">"org.apache.coyote.http11.Http11Nio2Protocol"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span></span></span><br><span class="line"><span class="hljs-tag">		    <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="APR"><a href="#APR" class="headerlink" title="APR"></a>APR</h3><p>即Apache Portable Runtime，从操作系统层面解决io阻塞问题。Tomcat7或Tomcat8在Win7或以上的系统中启动默认使用这种方式。Linux如果安装了apr和native，Tomcat直接启动就支持apr。</p>
<h2 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h2><p>默认值：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Executor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"tomcatThreadPool"</span> <span class="hljs-attr">namePrefix</span>=<span class="hljs-string">"catalina-exec-"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">maxThreads</span>=<span class="hljs-string">"150"</span> <span class="hljs-attr">minSpareThreads</span>=<span class="hljs-string">"4"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改为：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Executor</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">name</span>=<span class="hljs-string">"tomcatThreadPool"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">namePrefix</span>=<span class="hljs-string">"catalina-exec-"</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">maxThreads</span>=<span class="hljs-string">"500"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">minSpareThreads</span>=<span class="hljs-string">"100"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">prestartminSpareThreads</span> = <span class="hljs-string">"true"</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">maxQueueSize</span> = <span class="hljs-string">"100"</span></span></span><br><span class="line"><span class="hljs-tag">/&gt;</span></span><br></pre></td></tr></table></figure>

<p>参数解释：</p>
<ul>
<li>maxThreads，最大并发数，默认设置 200，一般建议在 500 ~ 800，根据硬件设施和业务来判断</li>
<li>minSpareThreads，Tomcat 初始化时创建的线程数，默认设置 25</li>
<li>prestartminSpareThreads，在 Tomcat 初始化的时候就初始化 minSpareThreads 的参数值，如果不等于 true，minSpareThreads 的值就没啥效果了</li>
<li>maxQueueSize，最大的等待队列数，超过则拒绝请求</li>
</ul>
<p>默认的链接参数配置：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">protocol</span>=<span class="hljs-string">"HTTP/1.1"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span> </span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span> </span></span><br><span class="line"><span class="hljs-tag">/&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改为：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span>  <span class="hljs-attr">executor</span>=<span class="hljs-string">"tomcatThreadPool"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">protocol</span>=<span class="hljs-string">"org.apache.coyote.http11.Http11Nio2Protocol"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span></span></span><br><span class="line"><span class="hljs-tag">		    <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>参数解释：</p>
<ul>
<li>protocol，Tomcat 8 设置 nio2 更好：org.apache.coyote.http11.Http11Nio2Protocol</li>
<li>protocol，Tomcat 6、7 设置 nio 更好：org.apache.coyote.http11.Http11NioProtocol</li>
<li>enableLookups，禁用DNS查询</li>
<li>acceptCount，指定当所有可以使用的处理请求的线程数都被使用时，可以放到处理队列中的请求数，超过这个数的请求将不予处理，默认设置 100</li>
<li>maxPostSize，以 FORM URL 参数方式的 POST 提交方式，限制提交最大的大小，默认是 2097152(2兆)，它使用的单位是字节。10485760 为 10M。如果要禁用限制，则可以设置为 -1</li>
<li>acceptorThreadCount，用于接收连接的线程的数量，默认值是1。一般这个指需要改动的时候是因为该服务器是一个多核CPU，如果是多核 CPU 一般配置为 2</li>
</ul>
<h2 id="端口配置"><a href="#端口配置" class="headerlink" title="端口配置"></a>端口配置</h2><p>Tomcat服务器需配置三个端口才能启动，安装时默认启用了这三个端口，当要运行多个tomcat服务时需要修改这三个端口。</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!-- 端口-1即可，标识随机 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Server</span> <span class="hljs-attr">port</span>=<span class="hljs-string">"-1"</span> <span class="hljs-attr">shutdown</span>=<span class="hljs-string">"SHUTDOWN"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!-- 访问端口，必须配置 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span>  <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">protocol</span>=<span class="hljs-string">"org.apache.coyote.http11.Http11Nio2Protocol"</span></span></span><br><span class="line"><span class="hljs-tag">            <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span></span></span><br><span class="line"><span class="hljs-tag">		    <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">&lt;!-- 配置Apache使用，如果使用Nginx代理注释掉即可 --&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> <span class="hljs-attr">port</span>=<span class="hljs-string">"8009"</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">"AJP/1.3"</span> <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="JVM-优化"><a href="#JVM-优化" class="headerlink" title="JVM 优化"></a>JVM 优化</h2><p>Java 的内存模型分为：</p>
<ul>
<li><p>Young，年轻代（易被 GC）。Young 区被划分为三部分，Eden 区和两个大小严格相同的 Survivor 区，其中 Survivor 区间中，某一时刻只有其中一个是被使用的，另外一个留做垃圾收集时复制对象用，在 Young 区间变满的时候，minor GC 就会将存活的对象移到空闲的Survivor 区间中，根据 JVM 的策略，在经过几次垃圾收集后，任然存活于 Survivor 的对象将被移动到 Tenured 区间。</p>
</li>
<li><p>Tenured，终身代。Tenured 区主要保存生命周期长的对象，一般是一些老的对象，当一些对象在 Young 复制转移一定的次数以后，对象就会被转移到 Tenured 区，一般如果系统中用了 application 级别的缓存，缓存中的对象往往会被转移到这一区间。</p>
</li>
<li><p>Perm，永久代。主要保存 class,method,filed 对象，这部门的空间一般不会溢出，除非一次性加载了很多的类，不过在涉及到热部署的应用服务器的时候，有时候会遇到 java.lang.OutOfMemoryError : PermGen space 的错误，造成这个错误的很大原因就有可能是每次都重新部署，但是重新部署后，类的 class 没有被卸载掉，这样就造成了大量的 class 对象保存在了 perm 中，这种情况下，一般重新启动应用服务器可以解决问题。</p>
</li>
</ul>
<p>Linux 修改 /tomcat/bin/catalina.sh 文件，把下面信息添加到文件第一行。</p>
<p>机子内存如果是 8G，一般 PermSize 配置是主要保证系统能稳定起来就行：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS=&quot;-Dfile.encoding=UTF-8 -server -Xms6144m -Xmx6144m -XX:NewSize=1024m -XX:MaxNewSize=2048m -XX:PermSize=512m -XX:MaxPermSize=512m -XX:MaxTenuringThreshold=10 -XX:NewRatio=2 -XX:+DisableExplicitGC&quot;</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-Dfile.encoding：默认文件编码</span><br><span class="line">-server：表示这是应用于服务器的配置，JVM 内部会有特殊处理的</span><br><span class="line">-Xmx1024m：设置JVM最大可用内存为1024MB</span><br><span class="line">-Xms1024m：设置JVM最小内存为1024m。此值可以设置与-Xmx相同，以避免每次垃圾回收完成后JVM重新分配内存。</span><br><span class="line">-XX:NewSize：设置年轻代大小</span><br><span class="line">-XX:MaxNewSize：设置最大的年轻代大小</span><br><span class="line">-XX:PermSize：设置永久代大小</span><br><span class="line">-XX:MaxPermSize：设置最大永久代大小</span><br><span class="line">-XX:NewRatio=4：设置年轻代（包括 Eden 和两个 Survivor 区）与终身代的比值（除去永久代）。设置为 4，则年轻代与终身代所占比值为 1：4，年轻代占整个堆栈的 1/5</span><br><span class="line">-XX:MaxTenuringThreshold=10：设置垃圾最大年龄，默认为：15。如果设置为 0 的话，则年轻代对象不经过 Survivor 区，直接进入年老代。对于年老代比较多的应用，可以提高效率。如果将此值设置为一个较大值，则年轻代对象会在 Survivor 区进行多次复制，这样可以增加对象再年轻代的存活时间，增加在年轻代即被回收的概论。</span><br><span class="line">-XX:+DisableExplicitGC：这个将会忽略手动调用 GC 的代码使得 System.gc() 的调用就会变成一个空调用，完全不会触发任何 GC</span><br></pre></td></tr></table></figure>


        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">上一页</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/3/">3</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/4/">4</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="新世界的KAMI">
                    
                    
                    <p class="is-size-4 is-block">
                        新世界的KAMI
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        ok
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>中华人民共和国</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        35
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/467812367" target="_blank">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/467812367">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/07/30/hexo+gitpages/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Hexo+Gitpages 搭建流程">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:27:37.078Z">2019-07-30</time></div>
                    <a href="/2019/07/30/hexo+gitpages/" class="has-link-black-ter is-size-6">Hexo+Gitpages 搭建流程</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/一些设计上的基本常识 - 梁飞/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="基本常识 （转）">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.225Z">2019-07-30</time></div>
                    <a href="/2019/07/30/一些设计上的基本常识 - 梁飞/" class="has-link-black-ter is-size-6">基本常识 （转）</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/为什么我们做分布式使用Redis/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="为什么使用 Redis">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.206Z">2019-07-30</time></div>
                    <a href="/2019/07/30/为什么我们做分布式使用Redis/" class="has-link-black-ter is-size-6">为什么使用 Redis</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/Zookeeper/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Zookeeper">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.205Z">2019-07-30</time></div>
                    <a href="/2019/07/30/Zookeeper/" class="has-link-black-ter is-size-6">Zookeeper</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/Dubbo知识精华-续/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Dubbo知识精华-2">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.202Z">2019-07-30</time></div>
                    <a href="/2019/07/30/Dubbo知识精华-续/" class="has-link-black-ter is-size-6">Dubbo知识精华-2</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">35</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/07/30/hexo+gitpages/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Hexo+Gitpages 搭建流程">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:27:37.078Z">2019-07-30</time></div>
                    <a href="/2019/07/30/hexo+gitpages/" class="has-link-black-ter is-size-6">Hexo+Gitpages 搭建流程</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/一些设计上的基本常识 - 梁飞/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="基本常识 （转）">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.225Z">2019-07-30</time></div>
                    <a href="/2019/07/30/一些设计上的基本常识 - 梁飞/" class="has-link-black-ter is-size-6">基本常识 （转）</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/为什么我们做分布式使用Redis/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="为什么使用 Redis">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.206Z">2019-07-30</time></div>
                    <a href="/2019/07/30/为什么我们做分布式使用Redis/" class="has-link-black-ter is-size-6">为什么使用 Redis</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/Zookeeper/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Zookeeper">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.205Z">2019-07-30</time></div>
                    <a href="/2019/07/30/Zookeeper/" class="has-link-black-ter is-size-6">Zookeeper</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/07/30/Dubbo知识精华-续/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Dubbo知识精华-2">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-07-30T06:23:54.202Z">2019-07-30</time></div>
                    <a href="/2019/07/30/Dubbo知识精华-续/" class="has-link-black-ter is-size-6">Dubbo知识精华-2</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">35</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="KAMI" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 KAMI&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>